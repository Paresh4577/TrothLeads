<div class="px-4 pb-4 max-h-none w-full">
    <div class="pt-4 sticky z-30 headingBorder top-0 w-full">
        <!-- region main heading -->
        <h1 class="new-head h-14 text-lg px-4 py-1.5 rounded flex justify-between items-center font-semibold">
            {{ title }}
            <div class="flex gap-x-3  items-center text-lg font-normal">
                <button mat-raised-button class="new-button" (click)="backClicked()">Cancel</button>
                <button mat-raised-button class="new-button" (click)="resetForm()">Reset</button>
                <!-- <button mat-raised-button class="new-button" (click)="ExpandCollaps()">
                    {{isExpand ? 'Collapse' : 'Expand All'}}
                </button> -->
                <button mat-raised-button class="new-button" (click)="generateReport()">Generate</button>
            </div>
        </h1>
    </div>
    <!-- endregion main heading -->

    <!-- region form -->
    <form [formGroup]="rfqReportForm">
        <!-- region body -->
        <div class="py-5 rounded">
            <mat-stepper orientation="vertical" #stepper [linear]="true" [ngClass]="isExpand ? 'showstep' : ''">

                <!-- Policy Details -->
                <mat-step label="Policy Details" [stepControl]="policyDetailsValidations()">

                    <div class="grid lg:grid-cols-3 md:grid-cols-2 gap-5 mt-4">

                        <!-- Branch -->
                        <div class="relative ">
                            <div class="icon">
                                <mat-icon>spa</mat-icon>
                            </div>
                            <select id="Branch" formControlName="BranchId">
                                <option value="" *ngIf="branches.length > 1">--Select--</option>
                                <option *ngFor="let Branch of branches" [value]="Branch.Id">
                                    {{Branch.Name}}
                                </option>
                            </select>
                            <label for="Branch" class="">Branch</label>
                        </div>

                        <!-- Policy Type -->
                        <div class="relative ">
                            <div class="icon">
                                <mat-icon>policy</mat-icon>
                            </div>
                            <select id="" formControlName="PolicyType">
                                <option value="">--Select--</option>
                                <option *ngFor="let option of displayedPolicyType" [value]="option.value">
                                    {{option.key}}
                                </option>
                            </select>
                            <label for="Type" class="">Policy Type</label>
                        </div>

                        <!-- BDM -->
                        <div class="relative ">
                            <div class="icon">
                                <mat-icon>person</mat-icon>
                            </div>
                        
                            <div class="flex">
                                <input type="text" class="peer " formControlName="BDMName" placeholder=" " id="BDMSearch"
                                    [matAutocomplete]="BDMSearch" autocomplete="off" />
                                <mat-autocomplete #BDMSearch="matAutocomplete" (optionSelected)="AutocompleteSelectedEvent($event,'BDM')">
                                    <mat-option *ngFor="let BDM of BDMList$ | async" [value]="BDM">
                                        {{BDM.FullName}}
                                    </mat-option>
                                </mat-autocomplete>
                                <button class="-m-5 z-10" type="button" (click)="openDiolog('User','Select BDM','BDM')">
                                    <mat-icon class="-ml-2">search</mat-icon>
                                </button>
                                <button type="button" class="-mx-7 z-10" matTooltip="Clear" (click)="clear('BDMName','BDMId')"
                                    *ngIf="rfqReportForm.get('BDMName').value">
                                    <mat-icon>clear</mat-icon>
                                </button>
                                <label for="BDMSearch">BDM</label>
                            </div>
                        
                        </div>
                        
                        <!-- BDO -->
                        <div class="relative ">
                            <div class="icon">
                                <mat-icon>person</mat-icon>
                            </div>
                        
                            <div class="flex">
                                <input type="text" class="peer " formControlName="BDOName" placeholder=" " id="BDOSearch"
                                    [matAutocomplete]="BDOSearch" autocomplete="off" />
                                <mat-autocomplete #BDOSearch="matAutocomplete" (optionSelected)="AutocompleteSelectedEvent($event,'BDO')">
                                    <mat-option *ngFor="let BDO of BDOList$ | async" [value]="BDO">
                                        {{BDO.FullName}}
                                    </mat-option>
                                </mat-autocomplete>
                                <button class="-m-5 z-10" type="button" (click)="openDiolog('User','Select BDO','BDO')">
                                    <mat-icon class="-ml-2">search</mat-icon>
                                </button>
                                <button type="button" class="-mx-7 z-10" matTooltip="Clear" (click)="clear('BDOName','BDOId')"
                                    *ngIf="rfqReportForm.get('BDOName').value">
                                    <mat-icon>clear</mat-icon>
                                </button>
                                <label for="BDOSearchh">BDO</label>
                            </div>
                        
                        </div>

                        <!-- Sales Person Name -->
                        <div class="relative">
                            <div class="icon">
                                <mat-icon>person</mat-icon>
                            </div>
                            <div class="flex">
                                <input type="text" class="peer " placeholder=" " id="SalesPersonName"
                                    [matAutocomplete]="SalesSearch" formControlName="SalesPersonName"
                                    autocomplete="off" />
                                <mat-autocomplete #SalesSearch="matAutocomplete"
                                    (optionSelected)="AutocompleteSelectedEvent($event,'SalesPersonName')">
                                    <mat-option *ngFor="let Sales of salesPerson$ | async" [value]="Sales">
                                        {{Sales.FullName}}
                                    </mat-option>
                                </mat-autocomplete>
                                <button class="-m-5 z-10" type="button"
                                    (click)="openDiolog('User','Select Sales Person','SalesPersonName')">
                                    <mat-icon class="-ml-2">search</mat-icon>
                                </button>
                                <button type="button" class="-mx-7 z-10" aria-label="clear" matTooltip="Clear"
                                    *ngIf="rfqReportForm.get('SalesPersonName').value"
                                    (click)="clear('SalesPersonName', 'SalesPersonId')">
                                    <mat-icon>clear</mat-icon>
                                </button>
                                <label for="SalesPersonName" class="">Sales Person Name</label>
                            </div>

                        </div>


                        <!-- Policy Period -->
                        <div class="relative ">
                            <div class="icon">
                                <mat-icon>pending_actions</mat-icon>
                            </div>
                            <select class="peer" id="PolicyPeriod" formControlName="PolicyPeriod">
                                <option value="">--Select--</option>
                                <option *ngFor="let option of displayedPolicyPeriod" [value]="option.value">
                                    {{option.name}}
                                </option>
                            </select>
                            <label for="Type" class="mandatory">RFQ Period</label>
                        </div>


                        <!-- From Date -->
                        <div class="relative" *ngIf="rfqReportForm.get('PolicyPeriod').value == 'DateRange'">
                            <div class="icon">
                                <mat-datepicker-toggle class="-ml-2" matIconSuffix
                                    [for]="FromDate"></mat-datepicker-toggle>
                                <mat-datepicker #FromDate></mat-datepicker>
                            </div>
                            <div class="flex">
                                <input matInput type="text" id="FromDate" placeholder="__/__/____" datemask
                                    formControlName="FromDate" [matDatepicker]="FromDate" class="peer" />
                                <label for="FromDate" class="mandatory">From Date</label>
                            </div>
                        </div>

                        <!-- To Date -->
                        <div class="relative" *ngIf="rfqReportForm.get('PolicyPeriod').value == 'DateRange'">
                            <div class="icon">
                                <mat-datepicker-toggle class="-ml-2" matIconSuffix
                                    [for]="ToDate"></mat-datepicker-toggle>
                                <mat-datepicker #ToDate></mat-datepicker>
                            </div>
                            <div class="flex">
                                <input matInput type="text" id="ToDate" placeholder="__/__/____" datemask
                                    formControlName="ToDate" [min]="rfqReportForm.get('FromDate').value"
                                    [matDatepicker]="ToDate" class="peer" />
                                <label for="ToDate" class="mandatory">To Date</label>
                            </div>
                        </div>


                    </div>

                    <div class="mt-3 flex flex-wrap gap-3" *ngIf="!isExpand">
                        <button class="bg-royal text-white" type="button" mat-button matStepperNext
                            (click)="policyDetailsError()">
                            Next
                        </button>
                    </div>

                </mat-step>

                <!-- Category Details -->
                <mat-step label="Category Details">

                    <div class="grid lg:grid-cols-3 sm:grid-cols-2 gap-5 mt-4">

                        <!-- Category -->
                        <div class="relative ">
                            <div class="icon">
                                <mat-icon>category</mat-icon>
                            </div>
                            <select class="peer bg-white" formControlName="CategoryId">
                                <option value="">--Select--</option>
                                <option *ngFor="let cat of categoryList" [value]="cat.Id">
                                    {{ cat.Name }}
                                </option>
                            </select>
                            <label for="Type" class="">Category</label>
                        </div>

                        <!-- Sub-Category -->
                        <div class="relative ">
                            <div class="icon">
                                <mat-icon>compass_calibration</mat-icon>
                            </div>
                            <select class="peer bg-white" formControlName="SubCategoryId">
                                <option value="">--Select--</option>
                                <option *ngFor="let option of subCategoryList" [value]="option.Id">
                                    {{ option.Name }}
                                </option>
                            </select>
                            <label for="Type" class="">Sub-Category</label>
                        </div>

                    </div>

                    <div class="mt-3 flex flex-wrap gap-3" *ngIf="!isExpand">
                        <button class="bg-royal text-white" type="button" mat-button matStepperPrevious>
                            Back
                        </button>
                        <button class="bg-royal text-white" type="button" mat-button matStepperNext>
                            Next
                        </button>
                    </div>

                </mat-step>

                <!-- RFQ Details -->
                <mat-step label="RFQ Details">

                    <div class="grid lg:grid-cols-3 sm:grid-cols-2 gap-5 mt-4">

                        <!-- RFQ Stage -->
                        <div class="relative ">
                            <div class="icon">
                                <mat-icon>spa</mat-icon>
                            </div>
                            <select id="Stage" formControlName="RFQStage">
                                <option *ngFor="let Stage of policyStatusList" [value]="Stage.Value">
                                    {{Stage.Text}}
                                </option>
                            </select>
                            <label for="Stage" class="">RFQ Stage</label>
                        </div>

                        <!-- Request Type -->
                        <div class="relative">
                            <div class="icon">
                                <mat-icon>person</mat-icon>
                            </div>
                            <select id="Type" formControlName="RequestType">
                                <option *ngFor="let Type of requestTypeList" [value]="Type.Value">
                                    {{Type.Text}}
                                </option>
                            </select>
                            <label for="Type" class="">Request Type</label>
                        </div>

                    </div>

                    <div class="mt-3 flex flex-wrap gap-3" *ngIf="!isExpand">
                        <button class="bg-royal text-white" type="button" mat-button matStepperPrevious>
                            Back
                        </button>
                        <button class="bg-royal text-white" type="button" mat-button matStepperNext>
                            Next
                        </button>
                    </div>

                </mat-step>

                <!-- Insurance Company  -->
                <mat-step label="Insurance Company ">

                    <div class="grid lg:grid-cols-3 sm:grid-cols-2 gap-5 mt-4">

                        <!-- Insurance Co. -->
                        <div class="relative ">
                            <div class="icon">
                                <mat-icon>domain</mat-icon>
                            </div>
                            <select class="peer" id="PolicyPeriod" formControlName="InsuranceCompany">
                                <option value="">--Select--</option>
                                <option *ngFor="let option of insuranceCompanyList" [value]="option.Code">
                                    {{option.ShortName}}
                                </option>
                            </select>
                            <label for="Type" class="">Insurance Co.</label>
                        </div>

                    </div>

                    <div class="mt-3 flex flex-wrap gap-3" *ngIf="!isExpand">
                        <button class="bg-royal text-white" type="button" mat-button matStepperPrevious>
                            Back
                        </button>
                        <button class="bg-royal text-white" type="button" mat-button matStepperNext>
                            Next
                        </button>
                    </div>

                </mat-step>



            </mat-stepper>
        </div>
        <!-- endregion body -->
    </form>
    <!-- endregion form -->

</div>