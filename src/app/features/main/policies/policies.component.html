<div class="w-full max-w-8xl mx-auto bg-white shadow-lg rounded-lg pl-0">
  <!-- Header Section -->
  <div class="text-white p-2 rounded-t-lg flex justify-between items-center"
    style="background-color:  var(--title-bg);">
    <p class="m-2 text-base" style="font-weight: 500;">Policy Management</p>
    <button
      style="padding: 6px 13px; border-radius: 25px; border: none; background-color: white; color: black; font-size: 15px; cursor: pointer;"
      *appCanWrite="'policies'" (click)="navigateToAddPolicy()">
      Add New
    </button>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="flex justify-center items-center mt-8">
    <div class="animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-600"></div>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-md mt-4">
    {{ errorMessage }}
  </div>

  <!-- Form Section (Input Table) -->
  <div class="mt-2 relative overflow-x-auto" style="height: calc(100vh - 200px);">
    <div class="absolute inset-0 overflow-x-auto">
      <table class="min-w-full border-collapse bg-cyan-600 shadow-md rounded-lg mb-2">
        <thead class="sticky top-0 z-10">
          <tr class="text-white" style="background-color:  var(--title-bg)">
            <th class="p-1 text-left whitespace-nowrap font-medium text-sm pt-2 ps-3">Policy No</th>
            <th class="p-1 text-left whitespace-nowrap font-medium text-sm pt-2 ps-3">Customer Name</th>
            <th class="p-1 text-left whitespace-nowrap font-medium text-sm pt-2 ps-3">Insurance Company Name</th>
            <th class="p-1 text-left whitespace-nowrap font-medium text-sm pt-2 ps-3">Policy Type</th>
            <th class="p-1 text-left whitespace-nowrap font-medium text-sm pt-2 ps-3">Action</th>
          </tr>

          <tr style="background-color: var(--title-bg)">
            <td class="p-2 align-middle">
              <input type="text"
                class="p-2 w-37 h-6 rounded-lg bg-white border border-gray-300 focus:ring-2 focus:ring-cyan-500 focus:border-transparent"
                [(ngModel)]="searchPolicyNo" (input)="searchPolicies()" />
            </td>
            <td class="p-2 align-middle">
            </td>
            <td class="p-2 align-middle">
            </td>
            <td class="p-2 align-middle">
            </td>
            <td class="p-2 align-middle">
            </td>

          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let policy of paginatedPolicies" class="border-b bg-white">
            <td class="p-3 w-40">{{ policy.PolicyNo || '-' }}</td>
            <td class="p-3 w-40">{{ policy.CustomerFullName || '-' }}</td>
            <td class="p-3 w-40">{{ policy.InsuranceCompanyName || '-' }}</td>
            <td class="p-3 w-40">{{ policy.PolicyType || '-' }}</td>
            <td class="p-3 w-40">
              <i *appCanWrite="'policies'" class="bx bx-show text-2xl" (click)="editPolicy(policy.PolicyId)"></i>
            </td>
          </tr>
        </tbody>

      </table>
    </div>
  </div>

  <!-- Empty State -->
  <div *ngIf="!isLoading && policies.length === 0" class="mt-6 bg-gray-100 p-6 rounded-md text-center shadow-md">
    <p class="text-gray-600">No Record Found.</p>
  </div>

  <!-- Add/Edit Form -->
  <div *ngIf="showForm" class="mt-6 bg-gray-100 p-6 rounded-md shadow-md">
    <h3 class="text-lg font-semibold mb-4">{{ isEditing ? 'Edit Policy' : 'Add Policy' }}</h3>
    <div class="grid grid-cols-1 gap-4">
      <input type="text" class="p-2 rounded-lg border border-gray-300" placeholder="Policy Name"
        [(ngModel)]="currentPolicy.PolicyName" />
      <input type="text" class="p-2 rounded-lg border border-gray-300" placeholder="Policy Code"
        [(ngModel)]="currentPolicy.PolicyCode" />
      <textarea class="p-2 rounded-lg border border-gray-300" placeholder="Description"
        [(ngModel)]="currentPolicy.Description"></textarea>
      <div class="flex justify-end">
        <button class="bg-cyan-600 text-white px-4 py-2 rounded-lg mr-2" (click)="submitPolicy()">
          {{ isEditing ? 'Update' : 'Save' }}
        </button>
        <button class="bg-gray-300 text-gray-700 px-4 py-2 rounded-lg" (click)="showForm = false">
          Cancel
        </button>
      </div>
    </div>
  </div>

  <!-- Pagination -->
  <div class="flex justify-between items-center p-4 mt-6 border-t">
    <div>
      <label for="itemsPerPage" class="text-gray-700 mr-2">Items per page:</label>
      <select id="itemsPerPage" class="border p-2 rounded-md text-gray-700 focus:ring-2 focus:ring-cyan-500"
        (change)="onItemsPerPageChange($event)">
        <option *ngFor="let option of itemsPerPageOptions" [value]="option" [selected]="itemsPerPage === option">
          {{ option }}
        </option>
      </select>
    </div>
    <div class="text-gray-700">
      Showing {{ (currentPage - 1) * itemsPerPage + 1 }} to {{ (currentPage - 1) * itemsPerPage +
      paginatedPolicies.length }} of {{ totalItems }} results
    </div>
  </div>
</div>